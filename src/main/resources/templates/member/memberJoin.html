<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{common/layout/adminLayout}">
<th:block layout:fragment="title">
    <!-- 각 페이지 마다 변경 -->
    <title>memberJoin</title>
</th:block>
<th:block layout:fragment="css">
    <!-- 각 페이지 마다 변경 -->
    <link rel="stylesheet" th:href="@{/css/member/memberJoin.css}">
</th:block>
<th:block layout:fragment="script">
    <!-- 각 페이지 마다 변경 -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js" defer></script>
    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <script th:src="@{/js/member/member.js}" defer></script>
    <script th:src="@{/js/member/address.js}" defer></script>
    <script th:src="@{/js/member/department.js}" defer></script>
</th:block>
<th:block layout:fragment="adminContainer">
    <div class="adminContainer">
        <div class="memberJoin">
            <div class="memberJoin-con">
                <h1>회원등록</h1>
                <div class="memberJoin1" id="memberJoin1">
                    <form th:action="@{/member/memberJoin}" method="post" th:object="${memberDto}"
                          enctype="multipart/form-data">
                        <ul>
                            <li>
                                <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
                                <script type="text/javascript">
                                    function sendNumber(){
                                      $("#mail_number").css("display","block");
                                        $.ajax({
                                            url:"/mail",
                                            type:"post",
                                            dataType:"json",
                                            data:{"mail" : $("#userEmail").val()},
                                            success: function(data){
                                                alert("인증번호 발송완료! 발송된 인증번호를 입력해주세요.");
                                                $("#Confirm").attr("value",data);
                                                $("#mail_number").css("display", "block");
                                            }
                                        });
                                    }

                                    function confirmNumber(){
                                        var number1 = $("#number").val();
                                        var number2 = $("#Confirm").val();

                                        if (number1.trim() === "") {
                                            alert("인증번호를 입력해주세요.");
                                        } else if(number1 == number2){
                                            alert("인증되었습니다.");
                                        }else{
                                            alert("번호가 다릅니다.");
                                            $("#number").val(""); // 입력된 인증번호 삭제
                                        }
                                    }

                                    function AllConfirm(){
                                        var number1 = $("#number").val();
                                        if (number1.trim() === "") {
                                            alert("이메일 인증은 필수입니다");
                                        }
                                    }
                                </script>


                                <label for="userEmail" class="label1">이 메 일</label>
                                <div id="mail_input" name="mail_input">
                                    <input type="text" name="userEmail" id="userEmail" placeholder="이메일 입력">
                                    <button type="button" id="sendBtn" name="sendBtn" onclick="sendNumber()">인증번호</button>
                                </div>
                                <br>
                                <div id="mail_number" name="mail_number" style="display:none">
                                    <input type="text" name="number" id="number" placeholder="인증번호 입력">
                                    <button type="button" name="confirmBtn" id="confirmBtn" onclick="confirmNumber()">이메일 인증</button>
                                </div>
                                <br>
                                <input type="text" id="Confirm" name="Confirm" style="display: none" value="">

<!--                                <input type="email" id="userEmail" th:field="*{userEmail}" placeholder="이 메 일"> <br>-->
                            </li>
                            <p th:if="${#fields.hasErrors('userEmail')}" th:errors="*{userEmail}" class="error"  style="color: #ff0000; font-size: 12px;"></p>

                            <li>
                                <label for="userPw" class="label1">비 밀 번 호</label>
                                <div id="showPw" class="showPw">
                                    <img th:src="@{/images/eye.png}" alt="이미지대체문구" height="24px">
                                </div>
                                <input type="password" id="userPw" th:field="*{userPw}" placeholder="비 밀 번 호">
                            </li>
                            <p th:if="${#fields.hasErrors('userPw')}" th:errors="*{userPw}" class="error"  style="color: #ff0000; font-size: 12px;"></p>

                            <li>
                                <label for="memberName" class="label1">이 름</label>
                                <input type="text" id="memberName" th:field="*{name}" placeholder="이 름"> <br>
                            </li>
                            <p th:if="${#fields.hasErrors('name')}" th:errors="*{name}" class="error"  style="color: #ff0000; font-size: 12px;"></p>

                            <li>
                                <label for="employeeDate" class="label1">입사일</label>
                                <input type="date" id="employeeDate" th:field="*{employeeDate}">
                            </li>
                            <p th:if="${#fields.hasErrors('employeeDate')}" th:errors="*{employeeDate}"
                               class="error"></p>

                            <li>
                                <label for="role" class="label1">권한</label>
                                <select name="role" id="role">
                                    <option value="MEMBER">member</option>
                                    <option value="MANAGER">manager</option>
                                    <option value="ADMIN">admin</option>
                                </select>

                            </li>
                            <p th:if="${#fields.hasErrors('role')}" th:errors="*{role}" class="error"></p>
                            <li>
                                <label for="topDepartmentSelect" class="label1">상위 부서</label>
                            </li>
                            <li>
                                <select name="departmentEntity.topDepartmentEntity" id="topDepartmentSelect">
                                    <option value="">상위 부서를 선택하세요</option>
                                    <th:block th:each="topDepartment : ${list}">
                                        <option th:value="${topDepartment.id}"
                                                th:utext="${topDepartment.topDepartmentName}"
                                                th:attr="data-department-list=${topDepartment.departmentEntityList}"></option>
                                    </th:block>
                                </select>
                            </li>

                            <li>
                                <select name="departmentEntity" id="departmentSelect">
                                    <option value="">부서를 선택하세요</option>
                                </select>
                            </li>
                            <li>
                                <label for="positionEntity.positionName" class="label1">직급</label>
                                <select name="positionEntity.positionName" id="positionEntity.positionName">
                                    <option value="사원">사원</option>
                                    <option value="부장">부장</option>
                                    <option value="대표이사">대표이사</option>
                                </select>
                            </li>
                            <p th:if="${#fields.hasErrors('positionEntity.positionName')}"
                               th:errors="*{positionEntity.positionName}"
                               class="error"></p>


                            <li>
                                <label for="address" class="label1">주 소</label>
                            </li>
                            <li class="addressCss">
                                <div class="address-con">
                                <input type="text" id="sample6_postcode" placeholder="우편번호">
                                <input type="button" onclick="sample6_execDaumPostcode()" value="우편번호 찾기">
                            </div>
                                <input type="text" id="sample6_address" placeholder="주소">
                                <input type="text" id="sample6_detailAddress" placeholder="상세주소">
                                <input type="hidden" id="address" placeholder="결합된 주소" th:field="*{address}">
                            </li>
                            <li>
                                <label for="phone" class="label1">전 화 번 호</label>

                                <input type="text" id="phone" oninput="memberPhoneNumberInput()" maxlength="13"
                                       th:field="*{phone}" placeholder="전화번호"> <br>
                            </li>

                            <li class="file">
                                <label for="memberFile" class="label1">사 진 첨 부</label>
                                <input type="file" name="memberFile" id="memberFile">
                            </li>

                            <li>
                                <input type="submit" class="submitBtn" onclick="AllConfirm()" value="회원등록">
                            </li>
                            <li>
                                <th:block th:if="error">
                                    <p style="color: #ff0000; font-size: 12px;"></p>
                                </th:block>
                            </li>
                        </ul>
                    </form>
                </div>

            </div>
        </div>
    </div>
</th:block>
</html>